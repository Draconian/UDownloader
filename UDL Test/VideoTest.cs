using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using UDL.Model;

namespace UDL_Test
{
    [TestClass]
    public class VideoTest
    {
        [TestMethod]
        public void GetVideoIDTest()
        {
            Video v = new Video();
            v.GetURLs("http://www.youtube.com/watch?v=sxwAuZn8bes&NR=1&feature=endscreen");

            PrivateObject accessor = new PrivateObject(v);

            String id = (String)accessor.Invoke("GetVideoID", null);

            //String id = v.GetVideoID();

            Assert.AreEqual("sxwAuZn8bes", id);


        }

        [TestMethod]
        public void GetVideoInfoUrlTest()
        {
            Video v = new Video();
            //v.GetURLs("http://www.youtube.com/watch?v=sxwAuZn8bes&NR=1&feature=endscreen");
            
            PrivateObject accessor = new PrivateObject(v);

            v.GetURLs("http://www.youtube.com/watch?NR=1&v=YU8ZM-oO0yM&feature=endscreen");

            //String url = "account_playback_token=&ptk=youtube_none&url_encoded_fmt_stream_map=itag%3D45%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v17---lscache1.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526key%253Dyt1%2526expire%253D1350272070%2526itag%253D45%2526ipbits%253D8%2526sver%253D3%2526ratebypass%253Dyes%2526mt%253D1350248772%2526ip%253D24.37.196.113%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fwebm%253B%2Bcodecs%253D%2522vp8.0%252C%2Bvorbis%2522%26fallback_host%3Dtc.v17.cache1.c.youtube.com%26sig%3DAE501C631950AE535491DDC5F554443C31A5027C.03A26DBF0B25991F1A94BE8015F315F313558108%26quality%3Dhd720%2Citag%3D22%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v6---lscache3.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526key%253Dyt1%2526expire%253D1350272070%2526itag%253D22%2526ipbits%253D8%2526sver%253D3%2526ratebypass%253Dyes%2526mt%253D1350248772%2526ip%253D24.37.196.113%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fmp4%253B%2Bcodecs%253D%2522avc1.64001F%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v6.cache3.c.youtube.com%26sig%3D133B90E6B243657F41279BFECEBCC3EC35E8AC73.3984EED9959038833DCF669FFB982F1662EAA584%26quality%3Dhd720%2Citag%3D44%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v8---lscache1.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526key%253Dyt1%2526expire%253D1350272070%2526itag%253D44%2526ipbits%253D8%2526sver%253D3%2526ratebypass%253Dyes%2526mt%253D1350248772%2526ip%253D24.37.196.113%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fwebm%253B%2Bcodecs%253D%2522vp8.0%252C%2Bvorbis%2522%26fallback_host%3Dtc.v8.cache1.c.youtube.com%26sig%3D07B80F4F247B5E910AB324077605C33485BE626F.508DC3A29278A73D057DDC2B5631544F4E3D1444%26quality%3Dlarge%2Citag%3D35%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v6---lscache1.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526expire%253D1350272070%2526algorithm%253Dthrottle-factor%2526burst%253D40%2526ip%253D24.37.196.113%2526itag%253D35%2526sver%253D3%2526key%253Dyt1%2526mt%253D1350248772%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526ipbits%253D8%2526factor%253D1.25%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fx-flv%26fallback_host%3Dtc.v6.cache1.c.youtube.com%26sig%3DA009E0FDC561498733F898563A349F954F18C21F.109910B1C10EA41D5A7E8C363CB186C9EEF9C830%26quality%3Dlarge%2Citag%3D43%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v13---lscache2.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526key%253Dyt1%2526expire%253D1350272070%2526itag%253D43%2526ipbits%253D8%2526sver%253D3%2526ratebypass%253Dyes%2526mt%253D1350248772%2526ip%253D24.37.196.113%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fwebm%253B%2Bcodecs%253D%2522vp8.0%252C%2Bvorbis%2522%26fallback_host%3Dtc.v13.cache2.c.youtube.com%26sig%3D1DFE46620F1B720BEA980CCD40302F806D5CC333.89AE39BD1296F68EB878129684601373C3B91888%26quality%3Dmedium%2Citag%3D34%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v10---lscache8.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526expire%253D1350272070%2526algorithm%253Dthrottle-factor%2526burst%253D40%2526ip%253D24.37.196.113%2526itag%253D34%2526sver%253D3%2526key%253Dyt1%2526mt%253D1350248772%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526ipbits%253D8%2526factor%253D1.25%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fx-flv%26fallback_host%3Dtc.v10.cache8.c.youtube.com%26sig%3D3B2EAF3761922A852ED641A04B1AC52DF98B56F0.CEFA024F8593CE02A01682FD36ECF6FB24B422D0%26quality%3Dmedium%2Citag%3D18%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v7---lscache3.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526key%253Dyt1%2526expire%253D1350272070%2526itag%253D18%2526ipbits%253D8%2526sver%253D3%2526ratebypass%253Dyes%2526mt%253D1350248772%2526ip%253D24.37.196.113%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fmp4%253B%2Bcodecs%253D%2522avc1.42001E%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v7.cache3.c.youtube.com%26sig%3D9765AF876B0D9BC6B0B34C5D3A65434AEF2B67E1.134E54A7B0F227ED2204ADBE6DD2ADE2C954D83F%26quality%3Dmedium%2Citag%3D5%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v20---lscache4.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526expire%253D1350272070%2526algorithm%253Dthrottle-factor%2526burst%253D40%2526ip%253D24.37.196.113%2526itag%253D5%2526sver%253D3%2526key%253Dyt1%2526mt%253D1350248772%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526ipbits%253D8%2526factor%253D1.25%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252Fx-flv%26fallback_host%3Dtc.v20.cache4.c.youtube.com%26sig%3DBE901C0309E9E2BE0DC8464880AEABE803D04E43.5F26D57E60E521821DBEE361B074C73FD307F1A6%26quality%3Dsmall%2Citag%3D36%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v17---lscache2.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526expire%253D1350272070%2526algorithm%253Dthrottle-factor%2526burst%253D40%2526ip%253D24.37.196.113%2526itag%253D36%2526sver%253D3%2526key%253Dyt1%2526mt%253D1350248772%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526ipbits%253D8%2526factor%253D1.25%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252F3gpp%253B%2Bcodecs%253D%2522mp4v.20.3%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v17.cache2.c.youtube.com%26sig%3D4B7C420780D359F8FFE710626B1AE99F3B7D844C.6B3F553EF4B58F1BCDD2D7C3D7B64D65DC4C8245%26quality%3Dsmall%2Citag%3D17%26url%3Dhttp%253A%252F%252Fo-o---preferred---sn-8qu-t0al---v17---lscache1.c.youtube.com%252Fvideoplayback%253Fupn%253D1_rsP4p8waI%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526fexp%253D927803%25252C903945%25252C927200%25252C908489%25252C919006%25252C927104%25252C922401%25252C920704%25252C912806%25252C927201%25252C913546%25252C913556%25252C925109%25252C919003%25252C912706%25252C900816%2526expire%253D1350272070%2526algorithm%253Dthrottle-factor%2526burst%253D40%2526ip%253D24.37.196.113%2526itag%253D17%2526sver%253D3%2526key%253Dyt1%2526mt%253D1350248772%2526mv%253Dm%2526source%253Dyoutube%2526ms%253Dau%2526ipbits%253D8%2526factor%253D1.25%2526cp%253DU0hURVJSUF9MSkNONF9KTFRBOk0tYllORGo0MUFn%2526id%253Db31c00b999fc6deb%26type%3Dvideo%252F3gpp%253B%2Bcodecs%253D%2522mp4v.20.3%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v17.cache1.c.youtube.com%26sig%3DD901BFF9CF5D13CF3BFCF27AC9845078C0FED6F2.61E706AC0AEC1BE9D34AFEEF34DA3AFAF61C46A8%26quality%3Dsmall&allow_embed=1&vq=auto&fexp=927803%2C903945%2C927200%2C908489%2C919006%2C927104%2C922401%2C920704%2C912806%2C927201%2C913546%2C913556%2C925109%2C919003%2C912706%2C900816&allow_ratings=1&keywords=yt%3Acrop%3D16%3A9%2Cles+robins+des+bois&track_embed=0&view_count=2969&video_verticals=%5B34%2C+184%2C+3%2C+35%2C+1038%5D&fmt_list=45%2F1280x720%2F99%2F0%2F0%2C22%2F1280x720%2F9%2F0%2F115%2C44%2F854x480%2F99%2F0%2F0%2C35%2F854x480%2F9%2F0%2F115%2C43%2F640x360%2F99%2F0%2F0%2C34%2F640x360%2F9%2F0%2F115%2C18%2F640x360%2F9%2F0%2F115%2C5%2F320x240%2F7%2F0%2F0%2C36%2F320x240%2F99%2F0%2F0%2C17%2F176x144%2F99%2F0%2F0&author=didipohu1&muted=0&length_seconds=843&pltype=contentugc&iurlmaxres=http%3A%2F%2Fi4.ytimg.com%2Fvi%2FsxwAuZn8bes%2Fmaxresdefault.jpg&has_cc=False&tmi=1&ftoken=&iurlsd=http%3A%2F%2Fi4.ytimg.com%2Fvi%2FsxwAuZn8bes%2Fsddefault.jpg&status=ok&watermark=%2Chttp%3A%2F%2Fs.ytimg.com%2Fyt%2Fimg%2Fwatermark%2Fyoutube_watermark-vflHX6b6E.png%2Chttp%3A%2F%2Fs.ytimg.com%2Fyt%2Fimg%2Fwatermark%2Fyoutube_hd_watermark-vflAzLcD6.png&timestamp=1350248833&storyboard_spec=http%3A%2F%2Fi4.ytimg.com%2Fsb%2FsxwAuZn8bes%2Fstoryboard3_L%24L%2F%24N.jpg%7C48%2327%23100%2310%2310%230%23default%239ToEEdVKM8i5C90BLOPDqUp2k7k%7C80%2345%23170%2310%2310%235000%23M%24M%23YygxiTryFIsGjfuPzmM9WWIoPz8%7C160%2390%23170%235%235%235000%23M%24M%230RTiFWN_v0Az-H1XDO2hALUcaj8%7C320%23180%23170%233%233%235000%23M%24M%236Z01bOHrK9xJijiXfeXXWLQUGlQ&plid=AATMC04YstXhDroI&endscreen_module=http%3A%2F%2Fs.ytimg.com%2Fyt%2Fswfbin%2Fendscreen-vfl4aPtOK.swf&hl=en_US&no_get_video_log=1&avg_rating=4.75&title=les+robins+des+bois+best+of+12&sendtmp=1&token=vjVQa1PpcFNOiIxEDBHFikRlMAiQqirQmIlXDcIbW-A%3D&thumbnail_url=http%3A%2F%2Fi4.ytimg.com%2Fvi%2FsxwAuZn8bes%2Fdefault.jpg&video_id=sxwAuZn8bes";
            //v.AnalyseVideoInfoURL(url);

            VideoURL[] vus = v.VideoURLs;

            VideoURL vu = vus[5];
            vu.Download(@"C:\");
        }

        [TestMethod]
        public void TypeParserTest()
        {

            String[] types = TypeParser.Parse(@"video/webm; codecs=""vp8.0, vorbis"",video/mp4; codecs=""avc1.64001F, mp4a.40.2"",video/webm; codecs=""vp8.0, vorbis"",video/x-flv,video/webm; codecs=""vp8.0, vorbis"",video/x-flv,video/mp4; codecs=""avc1.42001E, mp4a.40.2"",video/x-flv,video/3gpp; codecs=""mp4v.20.3, mp4a.40.2"",video/3gpp; codecs=""mp4v.20.3, mp4a.40.2""");


        }

        [TestMethod]
        public void QualityParserTest()
        {

            String[] qualities = QualityParser.Parse(@"hd720,itag=22,hd720,itag=44,large,itag=35,large,itag=43,medium,itag=34,medium,itag=18,medium,itag=5,small,itag=36,small,itag=17,small");


        }
    }
}
