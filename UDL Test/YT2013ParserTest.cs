using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using UDL.Model;
using UDL.Model.UrlParser;

namespace UDL_Test
{
	[TestClass]
    public class YT2013ParserTest
    {
        public static String dataURL = "fmt_list=45%2F1280x720%2F99%2F0%2F0%2C22%2F1280x720%2F9%2F0%2F115%2C44%2F854x480%2F99%2F0%2F0%2C35%2F854x480%2F9%2F0%2F115%2C43%2F640x360%2F99%2F0%2F0%2C34%2F640x360%2F9%2F0%2F115%2C18%2F640x360%2F9%2F0%2F115%2C5%2F320x240%2F7%2F0%2F0%2C36%2F320x240%2F99%2F0%2F0%2C17%2F176x144%2F99%2F0%2F0&tmi=1&video_verticals=%5B3%2C+1095%2C+184%2C+36%5D&thumbnail_url=http%3A%2F%2Fi4.ytimg.com%2Fvi%2FsxwAuZn8bes%2Fdefault.jpg&ftoken=&author=didipohu1&length_seconds=843&track_embed=0&allow_embed=1&ptk=youtube_none&iurlmaxres=http%3A%2F%2Fi4.ytimg.com%2Fvi%2FsxwAuZn8bes%2Fmaxresdefault.jpg&plid=AATSgSoV3rD1OI71&muted=0&hl=en_US&keywords=yt%3Acrop%3D16%3A9%2Cles+robins+des+bois&fexp=920704%2C912806%2C928001%2C922403%2C922405%2C929901%2C913605%2C929104%2C929110%2C913546%2C913556%2C908493%2C908496%2C920201%2C913302%2C919009%2C911116%2C926403%2C901451%2C902556&url_encoded_fmt_stream_map=type%3Dvideo%252Fwebm%253B%2Bcodecs%253D%2522vp8.0%252C%2Bvorbis%2522%26fallback_host%3Dtc.v17.cache1.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526key%253Dyt1%2526itag%253D45%2526expire%253D1357374870%2526ratebypass%253Dyes%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526source%253Dyoutube%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526mv%253Dm%26sig%3DB2E24513AAF9EF951F4011F05DB7E26AA764D5D3.9E946F0870DFBD35654A046B0938CED9EF17A192%26quality%3Dhd720%26itag%3D45%2Ctype%3Dvideo%252Fmp4%253B%2Bcodecs%253D%2522avc1.64001F%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v6.cache3.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526key%253Dyt1%2526itag%253D22%2526expire%253D1357374870%2526ratebypass%253Dyes%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526source%253Dyoutube%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526mv%253Dm%26sig%3D10D2BE7B2E1E4C20C58F347F9753C7DE0918F431.A67CC5523B144AA66759EFD0E5562F221F47EED8%26quality%3Dhd720%26itag%3D22%2Ctype%3Dvideo%252Fwebm%253B%2Bcodecs%253D%2522vp8.0%252C%2Bvorbis%2522%26fallback_host%3Dtc.v8.cache1.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526key%253Dyt1%2526itag%253D44%2526expire%253D1357374870%2526ratebypass%253Dyes%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526source%253Dyoutube%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526mv%253Dm%26sig%3D98C2A7E18BF110913A61DEFE81EE85E7D1B28848.1C91850F2BEA8E4657527D71E0401446D77AFFE7%26quality%3Dlarge%26itag%3D44%2Ctype%3Dvideo%252Fx-flv%26fallback_host%3Dtc.v6.cache1.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526burst%253D40%2526itag%253D35%2526key%253Dyt1%2526factor%253D1.25%2526algorithm%253Dthrottle-factor%2526expire%253D1357374870%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526mv%253Dm%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526source%253Dyoutube%26sig%3D1ECDCFFF92BAD96016829E8270727C34D94D0AAE.993EEA019AE2EDCA93C5EB91CA552431FFAF3CA7%26quality%3Dlarge%26itag%3D35%2Ctype%3Dvideo%252Fwebm%253B%2Bcodecs%253D%2522vp8.0%252C%2Bvorbis%2522%26fallback_host%3Dtc.v13.cache2.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526key%253Dyt1%2526itag%253D43%2526expire%253D1357374870%2526ratebypass%253Dyes%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526source%253Dyoutube%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526mv%253Dm%26sig%3D697BCFF7732ECA1630570B75787762FCE857E07A.1D8B97630E551DBD146911DE172D18C8823CE6A7%26quality%3Dmedium%26itag%3D43%2Ctype%3Dvideo%252Fx-flv%26fallback_host%3Dtc.v10.cache8.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526burst%253D40%2526itag%253D34%2526key%253Dyt1%2526factor%253D1.25%2526algorithm%253Dthrottle-factor%2526expire%253D1357374870%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526mv%253Dm%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526source%253Dyoutube%26sig%3D36214072A2FDA9D7FF828279AC2FCBC7E93BC90C.8384D6724A15ACD48481522B25D0257C0890803C%26quality%3Dmedium%26itag%3D34%2Ctype%3Dvideo%252Fmp4%253B%2Bcodecs%253D%2522avc1.42001E%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v7.cache3.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dcp%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Cratebypass%25252Csource%25252Cupn%25252Cexpire%2526key%253Dyt1%2526itag%253D18%2526expire%253D1357374870%2526ratebypass%253Dyes%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526source%253Dyoutube%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526mv%253Dm%26sig%3DCA126BA05A0C48176A3BCC8F689504F1614A8C23.61EE06F15E590CE74D7B20A4F4166935C2DCBEAE%26quality%3Dmedium%26itag%3D18%2Ctype%3Dvideo%252Fx-flv%26fallback_host%3Dtc.v20.cache4.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526burst%253D40%2526itag%253D5%2526key%253Dyt1%2526factor%253D1.25%2526algorithm%253Dthrottle-factor%2526expire%253D1357374870%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526mv%253Dm%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526source%253Dyoutube%26sig%3D63BC1A780B272B4AD5508DD6E2A67B7C19738F7D.6DF7E5F2FF7351DF7219CCD2CD4A83BC8EFC7F2A%26quality%3Dsmall%26itag%3D5%2Ctype%3Dvideo%252F3gpp%253B%2Bcodecs%253D%2522mp4v.20.3%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v17.cache2.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526burst%253D40%2526itag%253D36%2526key%253Dyt1%2526factor%253D1.25%2526algorithm%253Dthrottle-factor%2526expire%253D1357374870%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526mv%253Dm%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526source%253Dyoutube%26sig%3D03D500DC1FA1BEA9D6DBF73CA93F9A98B005C046.09C979AEFE2F3A9E6013F0021D1340DA3B3160F9%26quality%3Dsmall%26itag%3D36%2Ctype%3Dvideo%252F3gpp%253B%2Bcodecs%253D%2522mp4v.20.3%252C%2Bmp4a.40.2%2522%26fallback_host%3Dtc.v17.cache1.c.youtube.com%26url%3Dhttp%253A%252F%252Fr2---sn-8qu-t0al.c.youtube.com%252Fvideoplayback%253Fid%253Db31c00b999fc6deb%2526sparams%253Dalgorithm%25252Cburst%25252Ccp%25252Cfactor%25252Cid%25252Cip%25252Cipbits%25252Citag%25252Csource%25252Cupn%25252Cexpire%2526burst%253D40%2526itag%253D17%2526key%253Dyt1%2526factor%253D1.25%2526algorithm%253Dthrottle-factor%2526expire%253D1357374870%2526newshard%253Dyes%2526sver%253D3%2526ipbits%253D8%2526mv%253Dm%2526upn%253Dbhi7IfOu-Qc%2526ip%253D24.201.54.186%2526cp%253DU0hUTFNSUl9MSkNONF9LTFZJOmxvTXU5ZlpHeGV5%2526ms%253Dau%2526fexp%253D920704%25252C912806%25252C928001%25252C922403%25252C922405%25252C929901%25252C913605%25252C929104%25252C929110%25252C913546%25252C913556%25252C908493%25252C908496%25252C920201%25252C913302%25252C919009%25252C911116%25252C926403%25252C901451%25252C902556%2526mt%253D1357352051%2526source%253Dyoutube%26sig%3D0838C1C3EBA65320E9696D608D0A599CACF13A60.9804F41DCBD29CDE3A74652827135CD59C77F8BA%26quality%3Dsmall%26itag%3D17&timestamp=1357352105&iurlsd=http%3A%2F%2Fi4.ytimg.com%2Fvi%2FsxwAuZn8bes%2Fsddefault.jpg&endscreen_module=http%3A%2F%2Fs.ytimg.com%2Fyts%2Fswfbin%2Fendscreen-vflW8uRdM.swf&view_count=4299&has_cc=False&storyboard_spec=http%3A%2F%2Fi4.ytimg.com%2Fsb%2FsxwAuZn8bes%2Fstoryboard3_L%24L%2F%24N.jpg%7C48%2327%23100%2310%2310%230%23default%239ToEEdVKM8i5C90BLOPDqUp2k7k%7C80%2345%23170%2310%2310%235000%23M%24M%23YygxiTryFIsGjfuPzmM9WWIoPz8%7C160%2390%23170%235%235%235000%23M%24M%230RTiFWN_v0Az-H1XDO2hALUcaj8%7C320%23180%23170%233%233%235000%23M%24M%236Z01bOHrK9xJijiXfeXXWLQUGlQ&video_id=sxwAuZn8bes&title=les+robins+des+bois+best+of+12&abd=1&sendtmp=1&watermark=%2Chttp%3A%2F%2Fs.ytimg.com%2Fyts%2Fimg%2Fwatermark%2Fyoutube_watermark-vflHX6b6E.png%2Chttp%3A%2F%2Fs.ytimg.com%2Fyts%2Fimg%2Fwatermark%2Fyoutube_hd_watermark-vflAzLcD6.png&vq=auto&account_playback_token=&token=vjVQa1PpcFP388RLRHB7OLNJc3MMPmd2Z8kzi0MxyHY%3D&no_get_video_log=1&avg_rating=4.77777777778&status=ok&pltype=contentugc&allow_ratings=1";

		[TestMethod]
        public void TestExtractAuthor()
        {
            YT2013Parser urlWrap = new YT2013Parser(dataURL);
            String author = urlWrap.extractAuthor();

            Assert.AreEqual("didipohu1", author);
        }

		[TestMethod]
        public void TestExtractLength()
        {
            YT2013Parser urlWrap = new YT2013Parser(dataURL);
            int lengthSeconds = urlWrap.extractLengthSeconds();

            Assert.AreEqual(843, lengthSeconds);
        }

        [TestMethod]
        public void TestExtractTitle()
        {
            YT2013Parser urlWrap = new YT2013Parser(dataURL);
            String title = urlWrap.extractTitle();

            Assert.AreEqual("les robins des bois best of 12", title);
        }

        [TestMethod]
        public void TestExtractStatus()
        {
            YT2013Parser urlWrap = new YT2013Parser(dataURL);
            String status = urlWrap.extractStatus();

            Assert.AreEqual("ok", status);
        }

        [TestMethod]
        public void TestExtractThumbnailUrl()
        {
            YT2013Parser urlWrap = new YT2013Parser(dataURL);
            String thumbUrl = urlWrap.extractThumbnailUrl();

            Assert.AreEqual("http://i4.ytimg.com/vi/sxwAuZn8bes/default.jpg", thumbUrl);
        }

		[TestMethod]
        public void TestExtractStreamMap()
        {
            YT2013Parser urlWrap = new YT2013Parser(dataURL);
            String streamMap = urlWrap.extractStreamMap();

            Assert.AreEqual(8827, streamMap.Length);
        }
    }
}
